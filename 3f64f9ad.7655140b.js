(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{193:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return p}));var a=t(0),r=t.n(a);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=r.a.createContext({}),b=function(e){var n=r.a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=b(e.components);return r.a.createElement(c.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},m=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=b(t),m=a,p=u["".concat(i,".").concat(m)]||u[m]||d[m]||s;return t?r.a.createElement(p,o(o({ref:n},c),{},{components:t})):r.a.createElement(p,o({ref:n},c))}));function p(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,i=new Array(s);i[0]=m;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var c=2;c<s;c++)i[c]=t[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},90:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return o})),t.d(n,"rightToc",(function(){return l})),t.d(n,"default",(function(){return b}));var a=t(2),r=t(6),s=(t(0),t(193)),i={id:"ansible-overview",title:"Ansible Overview"},o={unversionedId:"infrastructure/configuration/ansible/ansible-overview",id:"infrastructure/configuration/ansible/ansible-overview",isDocsHomePage:!1,title:"Ansible Overview",description:"Playbooks",source:"@site/docs/infrastructure/configuration/ansible/ansible-overview.md",slug:"/infrastructure/configuration/ansible/ansible-overview",permalink:"/docs/infrastructure/configuration/ansible/ansible-overview",version:"current"},l=[{value:"Playbooks",id:"playbooks",children:[]},{value:"Variables",id:"variables",children:[]},{value:"Inventories",id:"inventories",children:[]},{value:"Modules",id:"modules",children:[]},{value:"Using Ansible",id:"using-ansible",children:[]},{value:"Check Mode",id:"check-mode",children:[]},{value:"Inventory",id:"inventory",children:[]},{value:"YAML",id:"yaml",children:[]}],c={rightToc:l};function b(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(a.a)({},c,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"playbooks"},"Playbooks"),Object(s.b)("p",null,"Plain text YAML files that describe the desired state of something.",Object(s.b)("br",{parentName:"p"}),"\n","Human and machine readable",Object(s.b)("br",{parentName:"p"}),"\n","Can be used to build entire application environments  "),Object(s.b)("h2",{id:"variables"},"Variables"),Object(s.b)("p",null,"Many different ways to source variables"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Playbooks  "),Object(s.b)("li",{parentName:"ul"},"Files  "),Object(s.b)("li",{parentName:"ul"},"Inventories (group vars and host vars)  "),Object(s.b)("li",{parentName:"ul"},"Command Line  "),Object(s.b)("li",{parentName:"ul"},"Discovered Variables (facts)  "),Object(s.b)("li",{parentName:"ul"},"Ansible Tower  ")),Object(s.b)("h2",{id:"inventories"},"Inventories"),Object(s.b)("p",null,"Static lines of servers",Object(s.b)("br",{parentName:"p"}),"\n","Ranges",Object(s.b)("br",{parentName:"p"}),"\n","Other custom things",Object(s.b)("br",{parentName:"p"}),"\n","Dynamic lists of servers: AWS, Azure, Google Cloud Platform, etc.",Object(s.b)("br",{parentName:"p"}),"\n","Ultimately, lists of things you want to automate across.  "),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Playbooks contain plays"),Object(s.b)("li",{parentName:"ul"},"plays contain tasks"),Object(s.b)("li",{parentName:"ul"},"tasks call modules")),Object(s.b)("p",null,"Tasks run sequentially"),Object(s.b)("p",null,"Handlers are triggered by tasks, and are run once, at the end of plays.  "),Object(s.b)("h2",{id:"modules"},"Modules"),Object(s.b)("p",null,"There are over 450 Ansible provided modules that automate nearly every part of your environment."),Object(s.b)("p",null,"Standard Structure: "),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"module: directive1=value directive2=value  ")),Object(s.b)("h2",{id:"using-ansible"},"Using Ansible"),Object(s.b)("p",null,"How to run:  "),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Ad-hoc - Call directly from the command line. Ansible 'inventory' -m"),Object(s.b)("li",{parentName:"ul"},"Playbook - ansible-playbook"),Object(s.b)("li",{parentName:"ul"},"Automation Framework - ansible tower")),Object(s.b)("h2",{id:"check-mode"},"Check Mode"),Object(s.b)("p",null,"Dry run for ad-hoc commands and Playbooks"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Validate playbook runs before making state changes on target systems")),Object(s.b)("h2",{id:"inventory"},"Inventory"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Defaults to being saved in /etc/ansible/hosts  "),Object(s.b)("li",{parentName:"ul"},"Specify different inventory using <path option on the command line  "),Object(s.b)("li",{parentName:"ul"},"The preferred practice in Ansible is to not store variables in the main inventory file.")),Object(s.b)("h2",{id:"yaml"},"YAML"),Object(s.b)("p",null,"YAML Ain't Markup Language"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"YAML is a human friendly data serialization standard for all programming languages.  "),Object(s.b)("li",{parentName:"ul"},"Ansible uses YAML because it is easier for humans to read and write than other common data formats like XML or JSON. Further, there are libraries available in most programming languages for working with YAML."),Object(s.b)("li",{parentName:"ul"},"YAML files begin with ",Object(s.b)("inlineCode",{parentName:"li"},"---")," and end with ",Object(s.b)("inlineCode",{parentName:"li"},"...")),Object(s.b)("li",{parentName:"ul"},'All members of a list are lines beginning at the same indentation level starting with a "- " (a dash and a space)'),Object(s.b)("li",{parentName:"ul"},"A dictionary is represented in a simple key: value form (there must be a space after the colon)"),Object(s.b)("li",{parentName:"ul"},"More complex data structures are possible, such as lists of dictionaries, dictionaries whose values are lists, or a mix of both."),Object(s.b)("li",{parentName:"ul"},"Dictionaries and lists can also be represented in abbreviated form.",Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",{parentName:"ul"},"Example:  ")))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{}),'\n---\nmartin: {name: Martin Dev, job: developer, skills: Elite}\nfruits: [\'Apple\',\'Orange\',\'Strawberry\',\'Mango\']\n\nAnsible does not use boolean values often, but they exist. Yes, no, true, or false may be used.\n\nInventories\n\nItems to automate \n\nhttps://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html\n\nYAML Syntax\n\nThis is important as YAML is used to write Ansible Playbooks\n\nhttps://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html#yaml-syntax\n\nAnsible Facts\n\nSetup Task - This task is run whenever a playbook is run and it gathers a whole host of facts about the remote machine(s)\u200a\u2014\u200aIP addresses, disks, OS version\u2026 etc. Ansible refers to these as \u201cfacts\u201d.\n\nAnsible Custom Facts\n\nhttps://medium.com/@jezhalford/ansible-custom-facts-1e1d1bf65db8\n\nCustom configuration of ansible facts. On any Ansible controlled host\u200a\u2014\u200athat is, the remote machine that is being controlled and not the machine on which the playbook is run\u200a\u2014\u200ayou just need to create a directory at /etc/ansible/facts.d. Inside this directory, you can place one or more *.fact files. These are files that return JSON data, which will then be included in the raft of facts that Ansible gathers at the start of each playbook run. You can name them anything you like, as long as they use the *.fact extension\n\nGather Facts\n\nFacts are described in the playbooks section and represent discovered variables about a system. These can be used to implement conditional execution of tasks but also just to get ad-hoc information about your system. You can see all facts via:\n\n$ ansible all -m setup\n\nIt\u2019s also possible to filter this output to just export certain facts\n\nFacts are information derived from speaking with your remote systems.\n\nAn example of this might be the IP address of the remote host, or what the operating system is.\n\nTo see what information is available, try the following:\n\nansible hostname -m setup\n\nThis will return a large amount of variable data\n\nAs discussed in the playbooks chapter, Ansible facts are a way of getting data about remote systems for use in playbook variables.\n\nUsually these are discovered automatically by the setup module in Ansible. Users can also write custom facts modules, as described in the API guide. However, what if you want to have a simple way to provide system or user provided data for use in Ansible variables, without writing a fact module?\n\n\u201cFacts.d\u201d is one mechanism for users to control some aspect of how their systems are managed.\n\nIf a remotely managed system has an /etc/ansible/facts.d directory, any files in this directory ending in .fact, can be JSON, INI, or executable files returning JSON, and these can supply local facts in Ansible. An alternate directory can be specified using the fact_path play keyword.\n\nFor example, assume /etc/ansible/facts.d/preferences.fact contains:\n\n[general]\n\n asdf=1\n\n bar=2\n\nThis will produce a hash variable fact named general with asdf and bar as members. To validate this, run the following:\n\nansible <hostname> -m setup -a "filter=ansible_local"\n\nAnd you will see the following fact added:\n\n"ansible_local": {\n\n"preferences": {\n\n"general": {\n\n"asdf" : "1",\n\n"bar": "2"\n\n}\n\n}\n\n}\n\nAnd this data can be accessed in a template/playbook as:\n\n{{ ansible_local.preferences.general.asdf }}\n\nThe local namespace prevents any user supplied fact from overriding system facts or variables defined elsewhere in the playbook.\n\nTo run a custom fact once the files are in place, you must specify the custom fact path (/home/vtguser/ansibleplaybooks/facts.d) :\n\nansible apsrt3596 -m setup -a "fact_path=\'/home/vtguser/ansibleplaybooks/facts.d\'" > /home/vtguser/ansibleplaybooks/customfacts/export/<whatever>.txt\n\nRun a playbook\n\nCustomFacts.yml --limit apsrt3596\n\nhttps://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#information-discovered-from-systems-facts\n\nansible xaas -i /home/vtguser/ansibleplaybooks/sandbox -m setup -a \'gather_subset=ohai\' --tree /home/vtguser/ansibleplaybooks/ohai/ohaidata/\n\nansible xaas -i /home/vtguser/ansibleplaybooks/sandbox -m setup -a \'gather_subset=ohai\' --tree /home/vtguser/ansibleplaybooks/\n\nset up task to\n\nwrite python script\n\n- skip in one level and go from there\n\nMaybe dump data to:\n\nrdb - relational databse\n\nResearch:\n\nansible filters\n\nansible tasks\n\njson should be good enough to compare outputs. Run with ansible and chef and diff outputs\n\n- figure out what info is relevant in chef and ansible \n\n:x\n\nwhich python\n\n#/bin/python +x\n\nhttps://linuxacademy.com/community/posts/show/topic/25690-gather-server-info-and-save-in-csv-file-with-ansbile\n\nhttps://github.com/fboender/ansible-cmdb\n\nhttps://github.com/fboender/ansible-cmdb/blob/master/src/ansible-cmdb.py\n\nPlural Sight\n')))}b.isMDXComponent=!0}}]);